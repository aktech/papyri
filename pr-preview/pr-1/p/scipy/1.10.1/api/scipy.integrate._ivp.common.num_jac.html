<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script src="https://unpkg.com/mystjs"></script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 310px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/numpy/1.24.2/api/numpy.html">numpy</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.10.1/api/scipy.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.10.1/api/scipy.html'>1.10.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.html">1.10.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.10.1/api/scipy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.10.1/api/scipy.html">API</a>
                        <a href="/p/scipy/1.10.1/gallery">Gallery</a>
                        <a href="/p/scipy/1.10.1/examples">Examples</a>
                        <a href="/p/scipy/1.10.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.html'>scipy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.integrate.html'>integrate</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/scipy.__config__.html.html">__config__</a>
<a href="/p/?/?/?/scipy._lib.html.html">_lib</a>
<a href="/p/scipy/1.10.1/api/scipy.cluster.html">cluster</a>
<a href="/p/scipy/1.10.1/api/scipy.datasets.html">datasets</a>
<a href="/p/scipy/1.10.1/api/scipy.fft.html">fft</a>
<a href="/p/scipy/1.10.1/api/scipy.fftpack.html">fftpack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.html">integrate</a>
<a href="/p/scipy/1.10.1/api/scipy.interpolate.html">interpolate</a>
<a href="/p/scipy/1.10.1/api/scipy.io.html">io</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.html">linalg</a>
<a href="/p/scipy/1.10.1/api/scipy.misc.html">misc</a>
<a href="/p/scipy/1.10.1/api/scipy.ndimage.html">ndimage</a>
<a href="/p/scipy/1.10.1/api/scipy.odr.html">odr</a>
<a href="/p/scipy/1.10.1/api/scipy.optimize.html">optimize</a>
<a href="/p/scipy/1.10.1/api/scipy.signal.html">signal</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.html">sparse</a>
<a href="/p/scipy/1.10.1/api/scipy.spatial.html">spatial</a>
<a href="/p/scipy/1.10.1/api/scipy.special.html">special</a>
<a href="/p/scipy/1.10.1/api/scipy.stats.html">stats</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.integrate._ivp.html'>_ivp</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.integrate._bvp.html">_bvp</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._dop.html">_dop</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.html">_ivp</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._lsoda.html">_lsoda</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ode.html">_ode</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._odepack.html">_odepack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._odepack_py.html">_odepack_py</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._quad_vec.html">_quad_vec</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._quadpack.html">_quadpack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._quadpack_py.html">_quadpack_py</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._quadrature.html">_quadrature</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._vode.html">_vode</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.dop.html">dop</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.lsoda.html">lsoda</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.odepack.html">odepack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.quadpack.html">quadpack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.vode.html">vode</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.integrate._ivp.common.html'>common</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.base.html">base</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.bdf.html">bdf</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.html">common</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.dop853_coefficients.html">dop853_coefficients</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.ivp.html">ivp</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.lsoda.html">lsoda</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.radau.html">radau</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.rk.html">rk</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.integrate._ivp.common.num_jac.html'>num_jac</a>                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.OdeSolution.html">OdeSolution</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common._dense_num_jac.html">_dense_num_jac</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common._sparse_num_jac.html">_sparse_num_jac</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.norm.html">norm</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.num_jac.html">num_jac</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.select_initial_step.html">select_initial_step</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.validate_first_step.html">validate_first_step</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.validate_max_step.html">validate_max_step</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.validate_tol.html">validate_tol</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate._ivp.common.warn_extraneous.html">warn_extraneous</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/scipy/1.10.1/img/scipy_logo.png"/>
    <a href="#">scipy</a>
    <a href="#">1.10.1</a>
        <a class='external'  href="https://pypi.org/project/scipy">Pypi</a>
        <a class='external' href="https://github.com/scipy/scipy">GitHub</a>
        <a class='external' href="https://scipy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://docs.scipy.org/doc/scipy/">Other Docs</a>
    <hr/>
        <ul>
        </ul>
        <hr/>

<a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a>    </div><!--end sidenav-->







<code class='signature'>num_jac(fun, t, y, f, threshold, factor, sparsity=None)</code><!-- rendering Extended Summary -->
                                       <div id="1f473dde42994b47b814f28266dbf607"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "This function computes finite difference approximation to the Jacobian matrix of "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "fun", "type": "RefInfo", "version": null}, "type": "Link", "value": "fun"}, {"type": "text", "value": " with respect to "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "y", "type": "RefInfo", "version": null}, "type": "Link", "value": "y"}, {"type": "text", "value": " using forward differences. The Jacobian matrix has shape (n, n) and its element (i, j) is equal to "}, {"type": "inlineCode", "value": "d f_i / d y_j"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("1f473dde42994b47b814f28266dbf607").innerHTML = html;
        }
        init();
    </script>

                               <div id="1d35ae668ae1484b8d793476bbdd576c"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "A special feature of this function is the ability to correct the step size from iteration to iteration. The main idea is to keep the finite difference significantly separated from its round-off error which approximately equals "}, {"type": "inlineCode", "value": "EPS * np.abs(f)"}, {"type": "text", "value": ". It reduces a possibility of a huge error and assures that the estimated derivative are reasonably close to the true values (i.e., the finite difference approximation is at least qualitatively reflects the structure of the true Jacobian)."}], "type": "paragraph"});
            document.getElementById("1d35ae668ae1484b8d793476bbdd576c").innerHTML = html;
        }
        init();
    </script>

<!-- rendering Notes -->
        <h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="fun">fun</a> : callable</dt>
<dd>
                <div id="beda219d12c5468584eb757c2d0a74b8"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Right-hand side of the system implemented in a vectorized fashion."}], "type": "paragraph"});
            document.getElementById("beda219d12c5468584eb757c2d0a74b8").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="t">t</a> : float</dt>
<dd>
                <div id="c630637d185e4d0697618db86e709ddd"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Current time."}], "type": "paragraph"});
            document.getElementById("c630637d185e4d0697618db86e709ddd").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="y">y</a> : ndarray, shape (n,)</dt>
<dd>
                <div id="82b3786052ab46ba95737349d33e7760"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Current state."}], "type": "paragraph"});
            document.getElementById("82b3786052ab46ba95737349d33e7760").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="f">f</a> : ndarray, shape (n,)</dt>
<dd>
                <div id="81b2cbeb440740d09807d6f5f45c9b9b"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Value of the right hand side at (t, y)."}], "type": "paragraph"});
            document.getElementById("81b2cbeb440740d09807d6f5f45c9b9b").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="threshold">threshold</a> : float</dt>
<dd>
                <div id="4244752944e54ff1abccf63a8bbe036b"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Threshold for "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "y", "type": "RefInfo", "version": null}, "type": "Link", "value": "y"}, {"type": "text", "value": " value used for computing the step size as "}, {"type": "inlineCode", "value": "factor * np.maximum(np.abs(y), threshold)"}, {"type": "text", "value": ". Typically, the value of absolute tolerance (atol) for a solver should be passed as "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "threshold", "type": "RefInfo", "version": null}, "type": "Link", "value": "threshold"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("4244752944e54ff1abccf63a8bbe036b").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="factor">factor</a> : ndarray with shape (n,) or None</dt>
<dd>
                <div id="0fe204c0167a4b1fa43c7d2e930660ca"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Factor to use for computing the step size. Pass None for the very evaluation, then use the value returned from this function."}], "type": "paragraph"});
            document.getElementById("0fe204c0167a4b1fa43c7d2e930660ca").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="sparsity">sparsity</a> : tuple (structure, groups) or None</dt>
<dd>
                <div id="a528abae14de40f387db0c571a9bc672"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Sparsity structure of the Jacobian, "}, {"domain": null, "role": null, "type": "Directive", "value": "structure"}, {"type": "text", "value": " must be csc_matrix."}], "type": "paragraph"});
            document.getElementById("a528abae14de40f387db0c571a9bc672").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="J">J</a> : ndarray or csc_matrix, shape (n, n)</dt>
<dd>
                <div id="f52c5383e3924185bdbb584a81952882"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Jacobian matrix."}], "type": "paragraph"});
            document.getElementById("f52c5383e3924185bdbb584a81952882").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="factor">factor</a> : ndarray, shape (n,)</dt>
<dd>
                <div id="05e544a9c89645ce87b6a001fd4558a1"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Suggested "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "factor", "type": "RefInfo", "version": null}, "type": "Link", "value": "factor"}, {"type": "text", "value": " for the next evaluation."}], "type": "paragraph"});
            document.getElementById("05e544a9c89645ce87b6a001fd4558a1").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<!-- rendering Summary -->
                                       <div id="944a74f192274fbb83e957cbc9843142"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Finite differences Jacobian approximation tailored for ODE solvers."}], "type": "paragraph"});
            document.getElementById("944a74f192274fbb83e957cbc9843142").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Examples">Examples</h3>
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/scipy/scipy/blob/v1.8.0//scipy/integrate/_ivp/common.py#L250'>/scipy/integrate/_ivp/common.py#250</a>
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>