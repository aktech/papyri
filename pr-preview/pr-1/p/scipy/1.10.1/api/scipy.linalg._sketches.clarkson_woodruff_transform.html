<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script src="https://unpkg.com/mystjs"></script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 310px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/numpy/1.24.2/api/numpy.html">numpy</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.10.1/api/scipy.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.10.1/api/scipy.html'>1.10.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.html">1.10.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.10.1/api/scipy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.10.1/api/scipy.html">API</a>
                        <a href="/p/scipy/1.10.1/gallery">Gallery</a>
                        <a href="/p/scipy/1.10.1/examples">Examples</a>
                        <a href="/p/scipy/1.10.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.html'>scipy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.linalg.html'>linalg</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/scipy.__config__.html.html">__config__</a>
<a href="/p/?/?/?/scipy._lib.html.html">_lib</a>
<a href="/p/scipy/1.10.1/api/scipy.cluster.html">cluster</a>
<a href="/p/scipy/1.10.1/api/scipy.datasets.html">datasets</a>
<a href="/p/scipy/1.10.1/api/scipy.fft.html">fft</a>
<a href="/p/scipy/1.10.1/api/scipy.fftpack.html">fftpack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.html">integrate</a>
<a href="/p/scipy/1.10.1/api/scipy.interpolate.html">interpolate</a>
<a href="/p/scipy/1.10.1/api/scipy.io.html">io</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.html">linalg</a>
<a href="/p/scipy/1.10.1/api/scipy.misc.html">misc</a>
<a href="/p/scipy/1.10.1/api/scipy.ndimage.html">ndimage</a>
<a href="/p/scipy/1.10.1/api/scipy.odr.html">odr</a>
<a href="/p/scipy/1.10.1/api/scipy.optimize.html">optimize</a>
<a href="/p/scipy/1.10.1/api/scipy.signal.html">signal</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.html">sparse</a>
<a href="/p/scipy/1.10.1/api/scipy.spatial.html">spatial</a>
<a href="/p/scipy/1.10.1/api/scipy.special.html">special</a>
<a href="/p/scipy/1.10.1/api/scipy.stats.html">stats</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.linalg._sketches.html'>_sketches</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.linalg._basic.html">_basic</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._cythonized_array_utils.html">_cythonized_array_utils</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp.html">_decomp</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_cholesky.html">_decomp_cholesky</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_cossin.html">_decomp_cossin</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_ldl.html">_decomp_ldl</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_lu.html">_decomp_lu</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_polar.html">_decomp_polar</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_qr.html">_decomp_qr</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_qz.html">_decomp_qz</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_schur.html">_decomp_schur</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_svd.html">_decomp_svd</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._decomp_update.html">_decomp_update</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._expm_frechet.html">_expm_frechet</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._fblas.html">_fblas</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._flapack.html">_flapack</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._flinalg.html">_flinalg</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._flinalg_py.html">_flinalg_py</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._interpolative.html">_interpolative</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._interpolative_backend.html">_interpolative_backend</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._matfuncs.html">_matfuncs</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._matfuncs_expm.html">_matfuncs_expm</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._matfuncs_sqrtm.html">_matfuncs_sqrtm</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._matfuncs_sqrtm_triu.html">_matfuncs_sqrtm_triu</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._misc.html">_misc</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._procrustes.html">_procrustes</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._sketches.html">_sketches</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._solve_toeplitz.html">_solve_toeplitz</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._solvers.html">_solvers</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._special_matrices.html">_special_matrices</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.basic.html">basic</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.blas.html">blas</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.cython_blas.html">cython_blas</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.cython_lapack.html">cython_lapack</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp.html">decomp</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp_cholesky.html">decomp_cholesky</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp_lu.html">decomp_lu</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp_qr.html">decomp_qr</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp_schur.html">decomp_schur</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.decomp_svd.html">decomp_svd</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.flinalg.html">flinalg</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.interpolative.html">interpolative</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.lapack.html">lapack</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.matfuncs.html">matfuncs</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.misc.html">misc</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.special_matrices.html">special_matrices</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.linalg._sketches.clarkson_woodruff_transform.html'>clarkson_woodruff_transform</a>                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.linalg._sketches.clarkson_woodruff_transform.html">clarkson_woodruff_transform</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg._sketches.cwt_matrix.html">cwt_matrix</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/scipy/1.10.1/img/scipy_logo.png"/>
    <a href="#">scipy</a>
    <a href="#">1.10.1</a>
        <a class='external'  href="https://pypi.org/project/scipy">Pypi</a>
        <a class='external' href="https://github.com/scipy/scipy">GitHub</a>
        <a class='external' href="https://scipy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://docs.scipy.org/doc/scipy/">Other Docs</a>
    <hr/>
        <ul>
        </ul>
        <hr/>

<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a>    </div><!--end sidenav-->







<code class='signature'>clarkson_woodruff_transform(input_matrix, sketch_size, seed=None)</code><!-- rendering Extended Summary -->
                                       <div id="d3a6cd11edc54b1a9e81595ab51ac8dc"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Given an input_matrix "}, {"type": "inlineCode", "value": "A"}, {"type": "text", "value": " of size "}, {"type": "inlineCode", "value": "(n, d)"}, {"type": "text", "value": ", compute a matrix "}, {"type": "inlineCode", "value": "A\u0027"}, {"type": "text", "value": " of size (sketch_size, d) so that"}], "type": "paragraph"});
            document.getElementById("d3a6cd11edc54b1a9e81595ab51ac8dc").innerHTML = html;
        }
        init();
    </script>

                       <span class="tex2jax_process">$$\|Ax\| \approx \|A&#39;x\|$$</span>

                               <div id="8dd9c94d05a648a9a7c85d491a0d57e1"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "with high probability via the Clarkson-Woodruff Transform, otherwise known as the CountSketch matrix."}], "type": "paragraph"});
            document.getElementById("8dd9c94d05a648a9a7c85d491a0d57e1").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                                       <div id="2a4f73108f114a06ab8f8d1275aac201"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "To make the statement"}], "type": "paragraph"});
            document.getElementById("2a4f73108f114a06ab8f8d1275aac201").innerHTML = html;
        }
        init();
    </script>

                       <span class="tex2jax_process">$$\|Ax\| \approx \|A&#39;x\|$$</span>

                               <div id="a9c58f34a93b481d84ac3d4db8d937a2"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "precise, observe the following result which is adapted from the proof of Theorem 14 of  via Markov\u0027s Inequality. If we have a sketch size "}, {"type": "inlineCode", "value": "sketch_size=k"}, {"type": "text", "value": " which is at least"}], "type": "paragraph"});
            document.getElementById("a9c58f34a93b481d84ac3d4db8d937a2").innerHTML = html;
        }
        init();
    </script>

                       <span class="tex2jax_process">$$k \geq \frac{2}{\epsilon^2\delta}$$</span>

                               <div id="de3e5dc1ebd545f7800c1603992fd0ed"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Then for any fixed vector "}, {"type": "inlineCode", "value": "x"}, {"type": "text", "value": ","}], "type": "paragraph"});
            document.getElementById("de3e5dc1ebd545f7800c1603992fd0ed").innerHTML = html;
        }
        init();
    </script>

                       <span class="tex2jax_process">$$\|Ax\| = (1\pm\epsilon)\|A&#39;x\|$$</span>

                               <div id="dea8eba6a0224d76aeeaa422722332d2"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "with probability at least one minus delta."}], "type": "paragraph"});
            document.getElementById("dea8eba6a0224d76aeeaa422722332d2").innerHTML = html;
        }
        init();
    </script>

                               <div id="f1a967d898804765af60ceabe8192b5b"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "This implementation takes advantage of sparsity: computing a sketch takes time proportional to "}, {"type": "inlineCode", "value": "A.nnz"}, {"type": "text", "value": ". Data "}, {"type": "inlineCode", "value": "A"}, {"type": "text", "value": " which is in "}, {"type": "inlineCode", "value": "scipy.sparse.csc_matrix"}, {"type": "text", "value": " format gives the quickest computation time for sparse input."}], "type": "paragraph"});
            document.getElementById("f1a967d898804765af60ceabe8192b5b").innerHTML = html;
        }
        init();
    </script>

                               <div id="f14ae77305d642538e31d07850ef62ce"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"type": "code", "value": "\u003e\u003e\u003e import numpy as np\n\u003e\u003e\u003e from scipy import linalg\n\u003e\u003e\u003e from scipy import sparse\n\u003e\u003e\u003e rng = np.random.default_rng()\n\u003e\u003e\u003e n_rows, n_columns, density, sketch_n_rows = 15000, 100, 0.01, 200\n\u003e\u003e\u003e A = sparse.rand(n_rows, n_columns, density=density, format=\u0027csc\u0027)\n\u003e\u003e\u003e B = sparse.rand(n_rows, n_columns, density=density, format=\u0027csr\u0027)\n\u003e\u003e\u003e C = sparse.rand(n_rows, n_columns, density=density, format=\u0027coo\u0027)\n\u003e\u003e\u003e D = rng.standard_normal((n_rows, n_columns))\n\u003e\u003e\u003e SA = linalg.clarkson_woodruff_transform(A, sketch_n_rows) # fastest\n\u003e\u003e\u003e SB = linalg.clarkson_woodruff_transform(B, sketch_n_rows) # fast\n\u003e\u003e\u003e SC = linalg.clarkson_woodruff_transform(C, sketch_n_rows) # slower\n\u003e\u003e\u003e SD = linalg.clarkson_woodruff_transform(D, sketch_n_rows) # slowest"});
            document.getElementById("f14ae77305d642538e31d07850ef62ce").innerHTML = html;
        }
        init();
    </script>

                               <div id="916469fd20dd45deb3044d6a0bd75d3e"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "That said, this method does perform well on dense inputs, just slower on a relative scale."}], "type": "paragraph"});
            document.getElementById("916469fd20dd45deb3044d6a0bd75d3e").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="input_matrix">input_matrix</a> : array_like</dt>
<dd>
                <div id="66171d16ffec4999a2b586e21d2ecfaa"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Input matrix, of shape "}, {"type": "inlineCode", "value": "(n, d)"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("66171d16ffec4999a2b586e21d2ecfaa").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="sketch_size">sketch_size</a> : int</dt>
<dd>
                <div id="e6caad38046847b0ae29da65a994441b"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Number of rows for the sketch."}], "type": "paragraph"});
            document.getElementById("e6caad38046847b0ae29da65a994441b").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="seed">seed</a> : {None, int, `numpy.random.Generator`, `numpy.random.RandomState`}, optional</dt>
<dd>
                <div id="81b0f17ac95c4c67a640814175f532fe"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "If "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "seed", "type": "RefInfo", "version": null}, "type": "Link", "value": "seed"}, {"type": "text", "value": " is None (or "}, {"domain": null, "role": null, "type": "Directive", "value": "np.random"}, {"type": "text", "value": "), the "}, {"anchor": null, "exists": true, "kind": "module", "reference": {"kind": "api", "module": "numpy", "path": "numpy.random.mtrand.RandomState", "type": "RefInfo", "version": "*"}, "type": "Link", "value": "numpy.random.RandomState"}, {"type": "text", "value": " singleton is used. If "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "seed", "type": "RefInfo", "version": null}, "type": "Link", "value": "seed"}, {"type": "text", "value": " is an int, a new "}, {"type": "inlineCode", "value": "RandomState"}, {"type": "text", "value": " instance is used, seeded with "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "seed", "type": "RefInfo", "version": null}, "type": "Link", "value": "seed"}, {"type": "text", "value": ". If "}, {"anchor": null, "exists": true, "kind": "local", "reference": {"kind": "local", "module": null, "path": "seed", "type": "RefInfo", "version": null}, "type": "Link", "value": "seed"}, {"type": "text", "value": " is already a "}, {"type": "inlineCode", "value": "Generator"}, {"type": "text", "value": " or "}, {"type": "inlineCode", "value": "RandomState"}, {"type": "text", "value": " instance then that instance is used."}], "type": "paragraph"});
            document.getElementById("81b0f17ac95c4c67a640814175f532fe").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="A&#39;">A&#39;</a> : array_like</dt>
<dd>
                <div id="c90f307969fd43f897d0e1aa7d029806"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Sketch of the input matrix "}, {"type": "inlineCode", "value": "A"}, {"type": "text", "value": ", of size "}, {"type": "inlineCode", "value": "(sketch_size, d)"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("c90f307969fd43f897d0e1aa7d029806").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<!-- rendering Summary -->
                                       <div id="0fcad11729364bf4be6d3753d5e79aea"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Applies a Clarkson-Woodruff Transform/sketch to the input matrix."}], "type": "paragraph"});
            document.getElementById("0fcad11729364bf4be6d3753d5e79aea").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Examples">Examples</h3>
                           Create a big dense matrix ``A`` for the example:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">import</span><span class=""> </span><span class="nn">numpy</span><span class=""> </span><span class="k">as</span><span class=""> </span><span class="nn">np</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">linalg</span><br><span class='nsl'>...&nbsp;</span><span class="">n_rows</span><span class="">,</span><span class=""> </span><span class="">n_columns</span><span class="">  </span><span class="o">=</span><span class=""> </span><span class="mi">15000</span><span class="">,</span><span class=""> </span><span class="mi">100</span><br><span class='nsl'>...&nbsp;</span><span class="">rng</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">random</span><span class="o">.</span><span class="">default_rng</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">A</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">rng</span><span class="o">.</span><span class="">standard_normal</span><span class="">(</span><span class="">(</span><span class="">n_rows</span><span class="">,</span><span class=""> </span><span class="">n_columns</span><span class="">)</span><span class="">)</span>
</pre>
            
                           Apply the transform to create a new matrix with 200 rows:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">sketch_n_rows</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">200</span><br><span class='nsl'>...&nbsp;</span><span class="">sketch</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">linalg</span><span class="o">.</span><span class="">clarkson_woodruff_transform</span><span class="">(</span><span class="">A</span><span class="">,</span><span class=""> </span><span class="">sketch_n_rows</span><span class="">,</span><span class=""> </span><span class="">seed</span><span class="o">=</span><span class="">rng</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">sketch</span><span class="o">.</span><span class="">shape</span>
(200, 100)</pre>
            
                           Now with high probability, the true norm is close to the sketched norm
in absolute value.  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">linalg</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">A</span><span class="">)</span>
1224.2812927123198</pre>
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">linalg</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">sketch</span><span class="">)</span>
1226.518328407333</pre>
            
                           Similarly, applying our sketch preserves the solution to a linear
regression of :math:`\min \|Ax - b\|`.  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">rng</span><span class="o">.</span><span class="">standard_normal</span><span class="">(</span><span class="">n_rows</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">linalg</span><span class="o">.</span><span class="">lstsq</span><span class="">(</span><span class="">A</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">Ab</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">hstack</span><span class="">(</span><span class="">(</span><span class="">A</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="o">.</span><span class="">reshape</span><span class="">(</span><span class="o">-</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">)</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">SAb</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">linalg</span><span class="o">.</span><span class="">clarkson_woodruff_transform</span><span class="">(</span><span class="">Ab</span><span class="">,</span><span class=""> </span><span class="">sketch_n_rows</span><span class="">,</span><span class=""> </span><span class="">seed</span><span class="o">=</span><span class="">rng</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">SA</span><span class="">,</span><span class=""> </span><span class="">Sb</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">SAb</span><span class="">[</span><span class="">:</span><span class="">,</span><span class=""> </span><span class="">:</span><span class="o">-</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">SAb</span><span class="">[</span><span class="">:</span><span class="">,</span><span class=""> </span><span class="o">-</span><span class="mi">1</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">x_sketched</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">linalg</span><span class="o">.</span><span class="">lstsq</span><span class="">(</span><span class="">SA</span><span class="">,</span><span class=""> </span><span class="">Sb</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span>
</pre>
            
                           As with the matrix norm example, ``linalg.norm(A @ x - b)`` is close
to ``linalg.norm(A @ x_sketched - b)`` with high probability.  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">linalg</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">A</span><span class=""> </span><span class="o">@</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">b</span><span class="">)</span>
122.83242365433877</pre>
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">linalg</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">A</span><span class=""> </span><span class="o">@</span><span class=""> </span><span class="">x_sketched</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">b</span><span class="">)</span>
166.58473879945151</pre>
            
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/scipy/scipy/blob/v1.8.0//scipy/linalg/_sketches.py#L56'>/scipy/linalg/_sketches.py#56</a>
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 14.782329983125269, "label": "numpy.random.mtrand.RandomState", "mod": "numpy", "url": "/p/numpy/1.24.2/api/numpy.random.mtrand.RandomState"}], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>