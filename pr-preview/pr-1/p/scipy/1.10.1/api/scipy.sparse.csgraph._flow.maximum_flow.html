<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script src="https://unpkg.com/mystjs"></script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 310px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/numpy/1.24.2/api/numpy.html">numpy</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.10.1/api/scipy.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.10.1/api/scipy.html'>1.10.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.html">1.10.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.10.1/api/scipy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.10.1/api/scipy.html">API</a>
                        <a href="/p/scipy/1.10.1/gallery">Gallery</a>
                        <a href="/p/scipy/1.10.1/examples">Examples</a>
                        <a href="/p/scipy/1.10.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.html'>scipy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.html'>sparse</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/scipy.__config__.html.html">__config__</a>
<a href="/p/?/?/?/scipy._lib.html.html">_lib</a>
<a href="/p/scipy/1.10.1/api/scipy.cluster.html">cluster</a>
<a href="/p/scipy/1.10.1/api/scipy.datasets.html">datasets</a>
<a href="/p/scipy/1.10.1/api/scipy.fft.html">fft</a>
<a href="/p/scipy/1.10.1/api/scipy.fftpack.html">fftpack</a>
<a href="/p/scipy/1.10.1/api/scipy.integrate.html">integrate</a>
<a href="/p/scipy/1.10.1/api/scipy.interpolate.html">interpolate</a>
<a href="/p/scipy/1.10.1/api/scipy.io.html">io</a>
<a href="/p/scipy/1.10.1/api/scipy.linalg.html">linalg</a>
<a href="/p/scipy/1.10.1/api/scipy.misc.html">misc</a>
<a href="/p/scipy/1.10.1/api/scipy.ndimage.html">ndimage</a>
<a href="/p/scipy/1.10.1/api/scipy.odr.html">odr</a>
<a href="/p/scipy/1.10.1/api/scipy.optimize.html">optimize</a>
<a href="/p/scipy/1.10.1/api/scipy.signal.html">signal</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.html">sparse</a>
<a href="/p/scipy/1.10.1/api/scipy.spatial.html">spatial</a>
<a href="/p/scipy/1.10.1/api/scipy.special.html">special</a>
<a href="/p/scipy/1.10.1/api/scipy.stats.html">stats</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.csgraph.html'>csgraph</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.sparse._arrays.html">_arrays</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._base.html">_base</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._bsr.html">_bsr</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._compressed.html">_compressed</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._construct.html">_construct</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._coo.html">_coo</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._csc.html">_csc</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._csparsetools.html">_csparsetools</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._csr.html">_csr</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._data.html">_data</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._dia.html">_dia</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._dok.html">_dok</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._extract.html">_extract</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._index.html">_index</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._lil.html">_lil</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._matrix_io.html">_matrix_io</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._sparsetools.html">_sparsetools</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse._sputils.html">_sputils</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.base.html">base</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.bsr.html">bsr</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.compressed.html">compressed</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.construct.html">construct</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.coo.html">coo</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csc.html">csc</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph.html">csgraph</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csr.html">csr</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.data.html">data</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.dia.html">dia</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.dok.html">dok</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.extract.html">extract</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.lil.html">lil</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.linalg.html">linalg</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.sparsetools.html">sparsetools</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.sputils.html">sputils</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.csgraph._flow.html'>_flow</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow.html">_flow</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._laplacian.html">_laplacian</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._matching.html">_matching</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._min_spanning_tree.html">_min_spanning_tree</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._reordering.html">_reordering</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._shortest_path.html">_shortest_path</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._tools.html">_tools</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._traversal.html">_traversal</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._validation.html">_validation</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.csgraph._flow.maximum_flow.html'>maximum_flow</a>                            <div class="dropdown-content">
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow.MaximumFlowResult.html">MaximumFlowResult</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow._add_reverse_edges.html">_add_reverse_edges</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow._make_edge_pointers.html">_make_edge_pointers</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow._make_tails.html">_make_tails</a>
<a href="/p/scipy/1.10.1/api/scipy.sparse.csgraph._flow.maximum_flow.html">maximum_flow</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/scipy/1.10.1/img/scipy_logo.png"/>
    <a href="#">scipy</a>
    <a href="#">1.10.1</a>
        <a class='external'  href="https://pypi.org/project/scipy">Pypi</a>
        <a class='external' href="https://github.com/scipy/scipy">GitHub</a>
        <a class='external' href="https://scipy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://docs.scipy.org/doc/scipy/">Other Docs</a>
    <hr/>
        <ul>
        </ul>
        <hr/>

<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Raises">Raises</a><a href="#section-Returns">Returns</a>    </div><!--end sidenav-->







<code class='signature'>maximum_flow(csgraph, source, sink)</code><!-- rendering Extended Summary -->
                                   <div class='admonition'>
    <div>versionadded 1.4.0</div>
</div>


<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                                       <div id="0632d55a18364a90ad8505ff782ee757"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "This solves the maximum flow problem on a given directed weighted graph: A flow associates to every edge a value, also called a flow, less than the capacity of the edge, so that for every vertex (apart from the source and the sink vertices), the total incoming flow is equal to the total outgoing flow. The value of a flow is the sum of the flow of all edges leaving the source vertex, and the maximum flow problem consists of finding a flow whose value is maximal."}], "type": "paragraph"});
            document.getElementById("0632d55a18364a90ad8505ff782ee757").innerHTML = html;
        }
        init();
    </script>

                               <div id="35bed71c8cc349589a4ff0c7076506ba"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "By the max-flow min-cut theorem, the maximal value of the flow is also the total weight of the edges in a minimum cut."}], "type": "paragraph"});
            document.getElementById("35bed71c8cc349589a4ff0c7076506ba").innerHTML = html;
        }
        init();
    </script>

                               <div id="373a5bfa28fe4d8d968cbce177ee66e3"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "To solve the problem, we provide Edmonds--Karp  and Dinic\u0027s algorithm . The implementation of both algorithms strive to exploit sparsity. The time complexity of the former "}, {"type": "Math", "value": "O(|V|\\,|E|^2)"}, {"type": "text", "value": " and its space complexity is "}, {"type": "Math", "value": "O(|E|)"}, {"type": "text", "value": ". The latter achieves its performance by building level graphs and finding blocking flows in them. Its time complexity is "}, {"type": "Math", "value": "O(|V|^2\\,|E|)"}, {"type": "text", "value": " and its space complexity is "}, {"type": "Math", "value": "O(|E|)"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("373a5bfa28fe4d8d968cbce177ee66e3").innerHTML = html;
        }
        init();
    </script>

                               <div id="0811a31f5758458a86773b485f574249"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "The maximum flow problem is usually defined with real valued capacities, but we require that all capacities are integral to ensure convergence. When dealing with rational capacities, or capacities belonging to "}, {"type": "Math", "value": "x\\mathbb{Q}"}, {"type": "text", "value": " for some fixed "}, {"type": "Math", "value": "x \\in \\mathbb{R}"}, {"type": "text", "value": ", it is possible to reduce the problem to the integral case by scaling all capacities accordingly."}], "type": "paragraph"});
            document.getElementById("0811a31f5758458a86773b485f574249").innerHTML = html;
        }
        init();
    </script>

                               <div id="7fc4c43e89b04d2783ecd7f291d655cf"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Solving a maximum-flow problem can be used for example for graph cuts optimization in computer vision ."}], "type": "paragraph"});
            document.getElementById("7fc4c43e89b04d2783ecd7f291d655cf").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="csgraph">csgraph</a> : csr_matrix</dt>
<dd>
                <div id="6a39a84f5fee4fba977e928900c5a509"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "The square matrix representing a directed graph whose (i, j)\u0027th entry is an integer representing the capacity of the edge between vertices i and j."}], "type": "paragraph"});
            document.getElementById("6a39a84f5fee4fba977e928900c5a509").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="source">source</a> : int</dt>
<dd>
                <div id="6cd48838a9a54231a4c1431d8727fd02"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "The source vertex from which the flow flows."}], "type": "paragraph"});
            document.getElementById("6cd48838a9a54231a4c1431d8727fd02").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="sink">sink</a> : int</dt>
<dd>
                <div id="03e01ca9790a47eda367a25ea633b64f"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "The sink vertex to which the flow flows."}], "type": "paragraph"});
            document.getElementById("03e01ca9790a47eda367a25ea633b64f").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt><a id="method: {&#39;edmonds_karp&#39;, &#39;dinic&#39;}, optional">method: {&#39;edmonds_karp&#39;, &#39;dinic&#39;}, optional</a> : </dt>
<dd>
                <div id="b063ead15d8943719a2549b94eb1fd88"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "The method/algorithm to be used for computing the maximum flow. Following methods are supported,"}], "type": "paragraph"});
            document.getElementById("b063ead15d8943719a2549b94eb1fd88").innerHTML = html;
        }
        init();
    </script>

            <blockquote>           <ul>               <li>                               <div id="db3749da47dc4a57b9d7ba7dda6cc9dc"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "\u0027edmonds_karp\u0027: Edmonds Karp algorithm in ."}], "type": "paragraph"});
            document.getElementById("db3749da47dc4a57b9d7ba7dda6cc9dc").innerHTML = html;
        }
        init();
    </script>

</li>
               <li>                               <div id="ce6eaa39a7834287aab53e54d5f0f0fe"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "\u0027dinic\u0027: Dinic\u0027s algorithm in ."}], "type": "paragraph"});
            document.getElementById("ce6eaa39a7834287aab53e54d5f0f0fe").innerHTML = html;
        }
        init();
    </script>

</li>
            </ul>
</blockquote>

                <div id="4081ac667a514cf5aa08def261d7b1f9"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Default is \u0027dinic\u0027."}], "type": "paragraph"});
            document.getElementById("4081ac667a514cf5aa08def261d7b1f9").innerHTML = html;
        }
        init();
    </script>

            <div class='admonition'>
    <div>versionadded 1.8.0</div>
</div>


</dd>
</dl>

<h3 id="section-Raises">Raises</h3>
<dl>
<dt>TypeError:</dt>
<dd>
                <div id="78d7181c571e49fb8c8aa3d1e09144c2"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "if the input graph is not in CSR format."}], "type": "paragraph"});
            document.getElementById("78d7181c571e49fb8c8aa3d1e09144c2").innerHTML = html;
        }
        init();
    </script>

</dd>
<dt>ValueError:</dt>
<dd>
                <div id="69d81a9d1d754012b9a61b8bc8433e89"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "if the capacity values are not integers, or the source or sink are out of bounds."}], "type": "paragraph"});
            document.getElementById("69d81a9d1d754012b9a61b8bc8433e89").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="res">res</a> : MaximumFlowResult</dt>
<dd>
                <div id="b14c260be289485ab8ccf124d8d3b088"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "A maximum flow represented by a "}, {"type": "inlineCode", "value": "MaximumFlowResult"}, {"type": "text", "value": " which includes the value of the flow in "}, {"type": "inlineCode", "value": "flow_value"}, {"type": "text", "value": ", and the flow graph in "}, {"type": "inlineCode", "value": "flow"}, {"type": "text", "value": "."}], "type": "paragraph"});
            document.getElementById("b14c260be289485ab8ccf124d8d3b088").innerHTML = html;
        }
        init();
    </script>

</dd>
</dl>

<!-- rendering Summary -->
                                       <div id="1df53ad5fc81423ea42680a26f0d3bd9"></div>
    <script>
        function init() {
            const myst = new MyST();
            const html = myst.renderMdast({"children": [{"type": "text", "value": "Maximize the flow between two vertices in a graph."}], "type": "paragraph"});
            document.getElementById("1df53ad5fc81423ea42680a26f0d3bd9").innerHTML = html;
        }
        init();
    </script>

<h3 id="section-Examples">Examples</h3>
                           Perhaps the simplest flow problem is that of a graph of only two vertices
with an edge from source (0) to sink (1)::  
            
                               (0) --5--&gt; (1)  
            
                           Here, the maximum flow is simply the capacity of the edge:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">import</span><span class=""> </span><span class="nn">numpy</span><span class=""> </span><span class="k">as</span><span class=""> </span><span class="nn">np</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class="nn">.</span><span class="nn">sparse</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">csr_matrix</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class="nn">.</span><span class="nn">sparse</span><span class="nn">.</span><span class="nn">csgraph</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">maximum_flow</span><br><span class='nsl'>...&nbsp;</span><span class="">graph</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">csr_matrix</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">maximum_flow</span><span class="">(</span><span class="">graph</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">)</span><span class="o">.</span><span class="">flow_value</span>
5</pre>
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">maximum_flow</span><span class="">(</span><span class="">graph</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">method</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">edmonds_karp</span><span class="s1">&#39;</span><span class="">)</span><span class="o">.</span><span class="">flow_value</span>
5</pre>
            
                           If, on the other hand, there is a bottleneck between source and sink, that
can reduce the maximum flow::  
            
                               (0) --5--&gt; (1) --3--&gt; (2)  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">graph</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">csr_matrix</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">maximum_flow</span><span class="">(</span><span class="">graph</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">2</span><span class="">)</span><span class="o">.</span><span class="">flow_value</span>
3</pre>
            
                           A less trivial example is given in [2]_, Chapter 26.1:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">graph</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">csr_matrix</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">16</span><span class="">,</span><span class=""> </span><span class="mi">13</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">10</span><span class="">,</span><span class=""> </span><span class="mi">12</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">4</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">14</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">9</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">20</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">7</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">4</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">,</span><span class="">  </span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">maximum_flow</span><span class="">(</span><span class="">graph</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">)</span><span class="o">.</span><span class="">flow_value</span>
23</pre>
            
                           It is possible to reduce the problem of finding a maximum matching in a
bipartite graph to a maximum flow problem: Let :math:`G = ((U, V), E)` be a
bipartite graph. Then, add to the graph a source vertex with edges to every
vertex in :math:`U` and a sink vertex with edges from every vertex in
:math:`V`. Finally, give every edge in the resulting graph a capacity of 1.
Then, a maximum flow in the new graph gives a maximum matching in the
original graph consisting of the edges in :math:`E` whose flow is positive.  
            
                           Assume that the edges are represented by a
:math:`\lvert U \rvert \times \lvert V \rvert` matrix in CSR format whose
:math:`(i, j)`&#39;th entry is 1 if there is an edge from :math:`i \in U` to
:math:`j \in V` and 0 otherwise; that is, the input is of the form required
by :func:`maximum_bipartite_matching`. Then the CSR representation of the
graph constructed above contains this matrix as a block. Here&#39;s an example:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">graph</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">csr_matrix</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="nb">print</span><span class="">(</span><span class="">graph</span><span class="o">.</span><span class="">toarray</span><span class="">(</span><span class="">)</span><span class="">)</span>
[[0 1 0 1]
 [1 0 1 0]
 [0 1 1 0]]</pre>
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">graph</span><span class="o">.</span><span class="">shape</span><br><span class='nsl'>...&nbsp;</span><span class="">n</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">graph</span><span class="o">.</span><span class="">nnz</span><br><span class='nsl'>...&nbsp;</span><span class="">indptr</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">concatenate</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                         </span><span class="">graph</span><span class="o">.</span><span class="">indptr</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                         </span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="">n</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">n</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                         </span><span class="">[</span><span class="">n</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">j</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">indices</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">concatenate</span><span class="">(</span><span class="">[</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                          </span><span class="">graph</span><span class="o">.</span><span class="">indices</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                          </span><span class="">np</span><span class="o">.</span><span class="">repeat</span><span class="">(</span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">j</span><span class="">)</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">data</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">ones</span><span class="">(</span><span class="">n</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">j</span><span class="">,</span><span class=""> </span><span class="">dtype</span><span class="o">=</span><span class="nb">int</span><span class="">)</span>
&gt;&gt;&gt;</pre>
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">graph_flow</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">csr_matrix</span><span class="">(</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">indices</span><span class="">,</span><span class=""> </span><span class="">indptr</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="nb">print</span><span class="">(</span><span class="">graph_flow</span><span class="o">.</span><span class="">toarray</span><span class="">(</span><span class="">)</span><span class="">)</span>
[[0 1 1 1 0 0 0 0 0]
 [0 0 0 0 0 1 0 1 0]
 [0 0 0 0 1 0 1 0 0]
 [0 0 0 0 0 1 1 0 0]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 0]]</pre>
            
                           At this point, we can find the maximum flow between the added sink and the
added source and the desired matching can be obtained by restricting the
flow function to the block corresponding to the original graph:  
            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">result</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">maximum_flow</span><span class="">(</span><span class="">graph_flow</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="">i</span><span class="o">+</span><span class="">j</span><span class="o">+</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">method</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">dinic</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">matching</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">result</span><span class="o">.</span><span class="">flow</span><span class="">[</span><span class="mi">1</span><span class="">:</span><span class="">i</span><span class="o">+</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">i</span><span class="o">+</span><span class="mi">1</span><span class="">:</span><span class="">i</span><span class="o">+</span><span class="">j</span><span class="o">+</span><span class="mi">1</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="nb">print</span><span class="">(</span><span class="">matching</span><span class="o">.</span><span class="">toarray</span><span class="">(</span><span class="">)</span><span class="">)</span>
[[0 1 0 0]
 [1 0 0 0]
 [0 0 1 0]]</pre>
            
                           This tells us that the first, second, and third vertex in :math:`U` are
matched with the second, first, and third vertex in :math:`V` respectively.  
            
                           While this solves the maximum bipartite matching problem in general, note
that algorithms specialized to that problem, such as
:func:`maximum_bipartite_matching`, will generally perform better.  
            
                           This approach can also be used to solve various common generalizations of
the maximum bipartite matching problem. If, for instance, some vertices can
be matched with more than one other vertex, this may be handled by
modifying the capacities of the new graph appropriately.  
            
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/scipy/scipy/blob/v1.8.0/None#LNone'>None#None</a>
<br/>

type: &lt;class &#39;builtin_function_or_method&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>